#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>

#include "encryption.h"
#include "decryption.h"

void printETC(uint8_t* MK, uint8_t* PT)
{
	printf("[KEY]\n");
	for (int i = 0; i < 16; i++)
	{
		printf("%02x ", MK[i]);
	}
	printf("\n\n");
	printf("[PT]\n");
	for (int i = 0; i < 8; i++)
	{
		printf("%02x ", PT[i]);
	}
	printf("\n\n");

	printf("[F0 Table]\n");
	for (int i = 0; i < 32; i++)
	{
		for (int j = 0; j < 8; j++)
		{
			uint8_t f0 = 0;
			F0(&f0, i * 8 + j);
			printf("0x%02X ", f0);
		}
		printf("\n");
	}
	printf("\n");

	printf("[F1 Table]\n");
	for (int i = 0; i < 32; i++)
	{
		for (int j = 0; j < 8; j++)
		{
			uint8_t f1 = 0;
			F1(&f1, i * 8 + j);
			printf("0x%02X ", f1);
		}
		printf("\n");
	}
	printf("\n");
}

int main()
{
	uint8_t MK[16] = { 0xff, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99, 0x88, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00 };
	//uint8_t PT[8] = { 0, };
	uint8_t CT[8] = { 0, };

	//uint8_t MK[16] = { 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff };
	//uint8_t PT[8] = { 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00 };

	//uint8_t MK[16] = { 0x0f, 0x0e, 0x0d, 0x0c, 0x0b, 0x0a, 0x09, 0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01, 0x00 };
	//uint8_t PT[8] = { 0xef, 0xcd, 0xab, 0x89, 0x67, 0x45, 0x23, 0x01 };

	//uint8_t MK[16] = { 0xe7, 0x2b, 0x42, 0x1d, 0xb1, 0x09, 0xa5, 0xcf, 0x7d, 0xd8, 0xff, 0x49, 0xbc, 0xc3, 0xdb, 0x28 };
	uint8_t PT[8] = { 0x14, 0x4a, 0xa8, 0xeb, 0xe2, 0x6b, 0x1e, 0xb4 };

	printETC(MK, PT);
	Encryption(CT, MK, PT);
	Decryption(PT, MK, CT);

	return 0;
}